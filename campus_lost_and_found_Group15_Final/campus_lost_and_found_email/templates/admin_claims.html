{% extends 'base.html' %}
{% block content %}
<h3>Admin — Claims</h3>

<p>
  <span class="badge bg-success">Approved (Returned)</span>
  <span class="badge bg-warning text-dark">Pending</span>
  <span class="badge bg-danger">Rejected (Unresolved)</span>
</p>

<h5 class="mt-4">Pending Claims</h5>
{% if pending %}
  <div class="row g-3">
    {% for it in pending %}
      <div class="col-12">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex align-items-start">
              <!-- Found / Proof / ID three-column layout -->
              <div class="d-flex flex-row w-100 justify-content-between">
                <div class="text-center" style="width:32%;">
                  <h6 class="mb-1">Found</h6>
                  {% if it.photo %}
                    <img src="{{ url_for('static', filename='uploads/' + it.photo) }}" class="img-fluid rounded" style="max-height:140px; object-fit:cover;">
                  {% else %}
                    <img src="{{ url_for('static', filename='uploads/placeholder.jpg') }}" class="img-fluid rounded" style="max-height:140px; object-fit:cover;">
                  {% endif %}
                </div>
                <div class="text-center" style="width:32%;">
                  <h6 class="mb-1">Proof</h6>
                  {% if it.proof_photo %}
                    <img src="{{ url_for('static', filename='uploads/' + it.proof_photo) }}" class="img-fluid rounded" style="max-height:140px; object-fit:cover;">
                  {% else %}
                    <div class="text-muted">No proof uploaded</div>
                  {% endif %}
                </div>
                <div class="text-center" style="width:32%;">
                  <h6 class="mb-1">ID</h6>
                  {% if it.id_photo %}
                    <img src="{{ url_for('static', filename='uploads/' + it.id_photo) }}" class="img-fluid rounded" style="max-height:140px; object-fit:cover;">
                  {% else %}
                    <div class="text-muted">No ID uploaded</div>
                  {% endif %}
                </div>
              </div>
            </div>

            <!-- similarity and claimant info -->
            <div class="text-center mt-3">
              <strong>Similarity:</strong>
              {% if it.similarity_score is not none %}
                <span class="mx-2">{{ it.similarity_score }}%</span>
              {% else %}
                <span class="mx-2">—</span>
              {% endif %}
            </div>

            <div class="row mt-3 align-items-center">
              <div class="col-md-6">
                <p class="mb-1"><strong>Claimant:</strong> {{ it.claimant_name or 'Unknown' }}</p>
                <p class="mb-0"><strong>Email:</strong> {{ it.claimant_email or '—' }}</p>
              </div>
              <div class="col-md-6 text-end">
                <!-- Approve / Reject buttons (forms to existing admin action routes) -->
                <a href="{{ url_for('admin_claim_action', item_id=it.id, action='approve') }}" class="btn btn-success me-2">Approve</a>
                <a href="{{ url_for('admin_claim_action', item_id=it.id, action='reject') }}" class="btn btn-danger">Reject</a>
              </div>
            </div>

          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-info">No pending claims.</div>
{% endif %}

<hr class="my-4">

<h5>Returned</h5>
{% if returned %}
  <div class="list-group mb-3">
    {% for it in returned %}
      <div class="list-group-item">
        <strong>{{ it.name }}</strong> — Returned on ID #{{ it.id }}
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="text-muted">No returned items.</div>
{% endif %}

<hr class="my-4">

<h5>Unresolved</h5>
{% if unresolved %}
  <div class="list-group mb-3">
    {% for it in unresolved %}
      <div class="list-group-item">
        <strong>{{ it.name }}</strong> — Unresolved
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="text-muted">No unresolved items.</div>
{% endif %}

{% endblock %}
